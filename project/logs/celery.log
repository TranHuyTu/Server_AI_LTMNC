[2023-11-07 18:06:30,440: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 18:06:30,453: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 18:06:31,484: INFO/MainProcess] mingle: all alone
[2023-11-07 18:06:31,517: INFO/MainProcess] celery@14c7cde4478e ready.
[2023-11-07 18:06:34,092: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 19:56:21,246: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 19:56:21,257: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 19:56:22,284: INFO/MainProcess] mingle: all alone
[2023-11-07 19:56:22,319: INFO/MainProcess] celery@14c7cde4478e ready.
[2023-11-07 19:56:24,995: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 20:03:05,767: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 20:03:05,772: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 20:03:06,784: INFO/MainProcess] mingle: all alone
[2023-11-07 20:03:06,799: INFO/MainProcess] celery@14c7cde4478e ready.
[2023-11-07 20:03:10,472: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 20:07:42,847: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 20:07:42,857: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 20:07:43,885: INFO/MainProcess] mingle: all alone
[2023-11-07 20:07:43,913: INFO/MainProcess] celery@14c7cde4478e ready.
[2023-11-07 20:07:47,052: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 20:22:32,052: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 20:22:32,060: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 20:22:33,074: INFO/MainProcess] mingle: all alone
[2023-11-07 20:22:33,091: INFO/MainProcess] celery@8dff9a11ec34 ready.
[2023-11-07 20:22:36,534: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 20:33:51,614: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 20:33:51,621: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 20:33:52,637: INFO/MainProcess] mingle: all alone
[2023-11-07 20:33:52,653: INFO/MainProcess] celery@c018df140554 ready.
[2023-11-07 20:33:56,362: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 20:46:19,328: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 20:46:19,441: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 20:46:20,552: INFO/MainProcess] mingle: all alone
[2023-11-07 20:46:20,863: INFO/MainProcess] celery@c14e964ccc24 ready.
[2023-11-07 20:46:25,449: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-07 21:12:05,155: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-07 21:12:05,185: INFO/MainProcess] mingle: searching for neighbors
[2023-11-07 21:12:06,230: INFO/MainProcess] mingle: all alone
[2023-11-07 21:12:06,449: INFO/MainProcess] celery@58eaddf3a88c ready.
[2023-11-07 21:12:06,986: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 03:01:59,429: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-08 03:01:59,451: INFO/MainProcess] mingle: searching for neighbors
[2023-11-08 03:02:00,487: INFO/MainProcess] mingle: all alone
[2023-11-08 03:02:00,539: INFO/MainProcess] celery@58eaddf3a88c ready.
[2023-11-08 03:02:03,261: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 09:18:36,041: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-08 09:18:36,048: INFO/MainProcess] mingle: searching for neighbors
[2023-11-08 09:18:37,070: INFO/MainProcess] mingle: all alone
[2023-11-08 09:18:37,193: INFO/MainProcess] celery@58eaddf3a88c ready.
[2023-11-08 09:18:40,678: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 09:43:15,606: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-08 09:43:15,630: INFO/MainProcess] mingle: searching for neighbors
[2023-11-08 09:43:16,670: INFO/MainProcess] mingle: all alone
[2023-11-08 09:43:16,762: INFO/MainProcess] celery@42754b1628c9 ready.
[2023-11-08 09:43:20,572: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 14:24:21,717: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-08 14:24:21,725: INFO/MainProcess] mingle: searching for neighbors
[2023-11-08 14:24:22,744: INFO/MainProcess] mingle: all alone
[2023-11-08 14:24:22,771: INFO/MainProcess] celery@42754b1628c9 ready.
[2023-11-08 14:24:25,963: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 15:57:57,199: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-08 15:57:57,225: INFO/MainProcess] mingle: searching for neighbors
[2023-11-08 15:57:58,276: INFO/MainProcess] mingle: all alone
[2023-11-08 15:57:58,302: INFO/MainProcess] celery@42754b1628c9 ready.
[2023-11-08 15:58:00,078: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 15:59:38,652: INFO/MainProcess] Task task_call_api[9396b822-54b3-4f5a-be06-13118b9aff69] received
[2023-11-08 15:59:39,234: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 15:59:39,251: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 15:59:39,252: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,253: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 15:59:39,254: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 15:59:39,255: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 15:59:39,257: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 15:59:39,259: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 15:59:39,262: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,263: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 15:59:39,264: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 15:59:39,265: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 15:59:39,266: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 15:59:39,267: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 15:59:39,268: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 15:59:39,269: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 15:59:39,270: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,270: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 15:59:39,272: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 15:59:39,272: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 15:59:39,274: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 15:59:39,275: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 15:59:39,276: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,278: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 15:59:39,281: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 15:59:39,286: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 15:59:39,291: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 15:59:39,315: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,320: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,321: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    response = requests.post(api_url, json=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,324: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,327: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,328: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,333: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,337: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 15:59:39,341: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 15:59:39,343: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 15:59:39,348: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 15:59:39,349: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,353: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,356: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,357: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,359: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,360: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 15:59:39,361: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,362: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,363: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 15:59:39,364: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,365: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 15:59:39,367: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 15:59:39,367: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 15:59:39,428: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 15:59:39,429: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 15:59:39,431: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 15:59:39,432: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 15:59:39,433: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 15:59:39,435: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 15:59:39,438: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 15:59:39,439: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 15:59:39,444: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 15:59:39,448: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 15:59:39,454: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 15:59:39,459: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 15:59:39,461: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 15:59:39,462: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 15:59:39,463: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 15:59:39,463: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 15:59:39,464: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 15:59:39,466: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 15:59:39,466: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 15:59:39,467: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 15:59:39,468: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 15:59:39,468: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 15:59:39,469: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 15:59:39,470: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 15:59:39,471: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 15:59:39,472: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 15:59:39,473: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 15:59:39,473: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 15:59:39,474: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 15:59:39,475: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 15:59:39,476: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 15:59:39,476: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 15:59:39,477: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 15:59:39,478: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 15:59:39,479: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '9396b822-54b3-4f5a-be06-13118b9aff69', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    response = requests.post(api_url, json=data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640bb27c10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:00:31,505: INFO/MainProcess] Task task_call_api[88934caf-70d2-4201-b0f0-034c1f00b191] received
[2023-11-08 16:00:32,309: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:00:32,316: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:00:32,317: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,318: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:00:32,319: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:00:32,320: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:00:32,320: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:00:32,321: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:00:32,323: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,324: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:00:32,325: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:00:32,326: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:00:32,327: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:00:32,328: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:00:32,329: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:00:32,330: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:00:32,331: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,332: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:00:32,333: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:00:32,334: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:00:32,335: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:00:32,336: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:00:32,337: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,337: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:00:32,338: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:00:32,339: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:00:32,339: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:00:32,341: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,343: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,344: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    response = requests.post(api_url, json=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,345: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,345: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,349: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,350: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,351: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:00:32,352: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:00:32,352: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:00:32,353: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:00:32,357: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,358: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,360: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,360: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,361: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,362: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:00:32,363: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,363: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,364: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:00:32,365: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,366: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:00:32,367: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:00:32,368: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:00:32,416: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:00:32,417: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:00:32,421: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:00:32,423: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:00:32,427: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:00:32,430: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:00:32,433: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:00:32,436: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:00:32,442: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:00:32,457: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:00:32,461: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:00:32,464: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:00:32,466: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:00:32,467: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:00:32,469: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:00:32,470: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:00:32,473: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:00:32,474: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:00:32,476: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:00:32,476: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:00:32,477: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:00:32,480: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:00:32,481: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:00:32,482: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:00:32,484: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:00:32,485: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:00:32,487: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:00:32,488: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:00:32,489: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:00:32,491: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:00:32,492: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:00:32,493: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:00:32,495: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:00:32,497: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:00:32,508: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '88934caf-70d2-4201-b0f0-034c1f00b191', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    response = requests.post(api_url, json=data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640c76b0d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:03:23,741: INFO/MainProcess] Task task_call_api[b0551ddd-7c7f-441d-a410-67b0a52bef55] received
[2023-11-08 16:03:25,430: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:03:25,440: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:03:25,442: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,455: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:03:25,469: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:03:25,476: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:03:25,478: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:03:25,490: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:03:25,529: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,530: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:03:25,532: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:03:25,538: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:03:25,539: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:03:25,540: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:03:25,541: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:03:25,542: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:03:25,543: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,545: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:03:25,546: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:03:25,550: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:03:25,551: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:03:25,553: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:03:25,554: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,556: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:03:25,558: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:03:25,559: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:03:25,560: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:03:25,562: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,563: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,564: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    response = requests.post(api_url, json=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,566: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,567: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,568: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,569: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,569: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:03:25,570: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:03:25,572: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:03:25,573: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:03:25,579: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,580: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,581: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,582: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,583: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,584: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:03:25,586: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,586: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,587: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:03:25,589: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,590: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:03:25,591: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:03:25,592: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:03:25,621: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:03:25,622: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:03:25,623: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:03:25,625: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:03:25,627: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:03:25,628: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:03:25,630: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:03:25,633: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:03:25,634: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:03:25,635: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:03:25,636: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:03:25,637: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:03:25,639: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:03:25,640: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:03:25,642: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:03:25,644: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:03:25,646: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:03:25,648: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:03:25,649: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:03:25,651: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:03:25,652: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:03:25,653: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:03:25,654: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:03:25,655: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:03:25,656: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:03:25,657: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:03:25,658: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:03:25,659: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:03:25,660: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:03:25,661: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:03:25,662: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:03:25,663: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:03:25,664: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:03:25,665: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:03:25,666: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': 'b0551ddd-7c7f-441d-a410-67b0a52bef55', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    response = requests.post(api_url, json=data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a4d50>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:05:38,399: INFO/MainProcess] Task task_call_api[aaeb1dde-6b93-4172-9fda-cb7bed78acbb] received
[2023-11-08 16:05:39,049: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:05:39,068: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:05:39,070: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,071: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:05:39,072: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:05:39,074: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:05:39,077: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:05:39,078: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:05:39,086: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,087: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:05:39,089: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:05:39,090: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:05:39,094: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:05:39,095: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:05:39,096: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:05:39,096: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:05:39,097: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,098: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:05:39,099: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:05:39,100: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:05:39,101: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:05:39,102: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:05:39,103: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,104: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:05:39,105: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:05:39,105: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:05:39,106: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:05:39,107: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,110: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,111: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    response = requests.post(api_url, json=data)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,112: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,113: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,114: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,115: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,116: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:05:39,117: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:05:39,118: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:05:39,118: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:05:39,121: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,122: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,124: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,128: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,130: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,134: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:05:39,135: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,139: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,140: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:05:39,140: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,143: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:05:39,145: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:05:39,146: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:05:39,204: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:05:39,205: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:05:39,212: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:05:39,214: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:05:39,214: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:05:39,219: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:05:39,220: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:05:39,221: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:05:39,222: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:05:39,223: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:05:39,224: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:05:39,226: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:05:39,227: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:05:39,229: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:05:39,230: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:05:39,235: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:05:39,236: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:05:39,238: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:05:39,242: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:05:39,245: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:05:39,246: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:05:39,248: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:05:39,249: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:05:39,250: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:05:39,252: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:05:39,254: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:05:39,255: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:05:39,256: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:05:39,257: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:05:39,261: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:05:39,262: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:05:39,281: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:05:39,283: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:05:39,285: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:05:39,287: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': 'aaeb1dde-6b93-4172-9fda-cb7bed78acbb', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    response = requests.post(api_url, json=data)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a9110>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:11:51,162: INFO/MainProcess] Task task_call_api[131bcfe7-63ed-4d11-80c8-ab8488895d04] received
[2023-11-08 16:11:55,978: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:11:56,022: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:11:56,035: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,053: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:11:56,056: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:11:56,062: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:11:56,072: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:11:56,075: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:11:56,097: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,102: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:11:56,105: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:11:56,130: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:11:56,135: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:11:56,154: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:11:56,162: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:11:56,179: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:11:56,187: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,190: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:11:56,198: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:11:56,206: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:11:56,211: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:11:56,216: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:11:56,222: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,230: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:11:56,235: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:11:56,238: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:11:56,242: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:11:56,245: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,248: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,256: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,266: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,268: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,270: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,273: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:11:56,281: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:11:56,284: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:11:56,287: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:11:56,324: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,326: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,328: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,330: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,334: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,336: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:11:56,338: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,341: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,343: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:11:56,344: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,373: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:11:56,379: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:11:56,381: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:11:56,484: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:11:56,486: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:11:56,492: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:11:56,494: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:11:56,497: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:11:56,503: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:11:56,505: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:11:56,511: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:11:56,512: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:11:56,513: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:11:56,515: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:11:56,519: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:11:56,521: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:11:56,522: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:11:56,526: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:11:56,532: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:11:56,539: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:11:56,546: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:11:56,551: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:11:56,553: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:11:56,554: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:11:56,559: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:11:56,580: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:11:56,586: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:11:56,587: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:11:56,588: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:11:56,591: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:11:56,592: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:11:56,594: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:11:56,596: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:11:56,602: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:11:56,606: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:11:56,637: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:11:56,644: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:11:56,649: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '131bcfe7-63ed-4d11-80c8-ab8488895d04', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8adb10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:12:21,195: INFO/MainProcess] Task task_call_api[e09c8385-d04d-45bf-99dd-a4c79515c94a] received
[2023-11-08 16:12:21,594: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:12:21,607: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:12:21,608: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,610: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:12:21,612: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:12:21,613: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:12:21,614: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:12:21,615: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:12:21,619: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,621: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:12:21,622: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:12:21,623: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:12:21,625: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:12:21,628: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:12:21,631: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:12:21,632: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:12:21,635: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,636: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:12:21,637: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:12:21,638: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:12:21,639: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:12:21,641: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:12:21,642: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,646: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:12:21,649: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:12:21,651: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:12:21,653: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:12:21,655: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,658: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,660: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,662: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,663: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,667: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,670: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,671: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:12:21,672: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:12:21,672: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:12:21,674: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:12:21,678: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,680: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,682: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,684: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,684: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,686: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:12:21,687: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,688: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,689: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:12:21,691: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,691: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:12:21,692: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:12:21,693: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:12:21,716: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:12:21,718: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:12:21,719: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:12:21,720: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:12:21,721: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:12:21,721: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:12:21,722: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:12:21,723: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:12:21,724: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:12:21,725: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:12:21,726: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:12:21,727: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:12:21,727: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:12:21,728: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:12:21,729: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:12:21,731: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:12:21,731: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:12:21,732: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:12:21,733: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:12:21,734: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:12:21,735: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:12:21,735: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:12:21,737: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:12:21,737: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:12:21,738: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:12:21,739: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:12:21,740: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:12:21,742: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:12:21,744: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:12:21,745: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:12:21,748: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:12:21,748: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:12:21,750: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:12:21,751: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:12:21,753: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': 'e09c8385-d04d-45bf-99dd-a4c79515c94a', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8c2ad0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:13:45,025: INFO/MainProcess] Task task_call_api[130898f4-9e35-4f8c-b132-701639516a05] received
[2023-11-08 16:13:45,239: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:13:45,245: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:13:45,246: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,247: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:13:45,248: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:13:45,249: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:13:45,249: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:13:45,250: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:13:45,251: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,252: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:13:45,253: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:13:45,253: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:13:45,254: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:13:45,255: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:13:45,256: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:13:45,256: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:13:45,257: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,258: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:13:45,258: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:13:45,259: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:13:45,260: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:13:45,261: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:13:45,261: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,262: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:13:45,263: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:13:45,264: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:13:45,264: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:13:45,265: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,266: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,267: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,268: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,269: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,269: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,270: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:13:45,273: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:13:45,274: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:13:45,277: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:13:45,279: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,279: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,280: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,281: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,282: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,282: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:13:45,284: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,285: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,285: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:13:45,286: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,287: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:13:45,288: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:13:45,288: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:13:45,302: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:13:45,303: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:13:45,305: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:13:45,306: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:13:45,307: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:13:45,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:13:45,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:13:45,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:13:45,310: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:13:45,311: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:13:45,312: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:13:45,314: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:13:45,315: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:13:45,316: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:13:45,318: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:13:45,319: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:13:45,319: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:13:45,320: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:13:45,321: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:13:45,322: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:13:45,330: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:13:45,333: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:13:45,334: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:13:45,335: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:13:45,338: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:13:45,339: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:13:45,340: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:13:45,343: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:13:45,345: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:13:45,347: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:13:45,349: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:13:45,351: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:13:45,354: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:13:45,355: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:13:45,356: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '130898f4-9e35-4f8c-b132-701639516a05', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b899a90>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:14:12,689: INFO/MainProcess] Task create_task[b573dce9-d50d-4972-9d12-0c428a19c6ab] received
[2023-11-08 16:14:23,566: INFO/ForkPoolWorker-7] Task create_task[b573dce9-d50d-4972-9d12-0c428a19c6ab] succeeded in 10.74889690800046s: True
[2023-11-08 16:18:04,808: INFO/MainProcess] Task task_call_api[89dcb033-9648-440a-b273-522bed9c103c] received
[2023-11-08 16:18:05,121: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:18:05,141: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:18:05,143: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,146: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:18:05,148: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:18:05,149: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:18:05,150: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:18:05,152: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:18:05,155: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,156: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:18:05,158: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:18:05,159: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:18:05,162: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:18:05,163: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:18:05,164: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:18:05,166: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:18:05,171: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,172: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:18:05,173: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:18:05,174: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:18:05,176: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:18:05,177: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:18:05,178: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,179: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:18:05,179: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:18:05,180: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:18:05,181: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:18:05,182: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,183: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,184: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,185: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,186: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,186: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,187: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,188: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:18:05,189: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:18:05,190: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:18:05,190: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:18:05,201: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,203: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,205: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,207: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,208: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,209: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:18:05,211: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,213: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,215: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:18:05,216: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,219: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:18:05,224: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:18:05,226: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:18:05,255: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:18:05,258: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:18:05,259: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:18:05,265: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:18:05,269: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:18:05,270: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:18:05,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:18:05,273: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:18:05,274: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:18:05,276: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:18:05,277: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:18:05,278: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:18:05,279: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:18:05,287: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:18:05,288: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:18:05,289: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:18:05,290: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:18:05,291: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:18:05,292: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:18:05,295: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:18:05,296: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:18:05,297: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:18:05,298: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:18:05,299: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:18:05,300: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:18:05,301: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:18:05,303: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:18:05,304: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:18:05,305: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:18:05,306: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:18:05,307: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:18:05,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:18:05,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:18:05,310: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:18:05,311: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '89dcb033-9648-440a-b273-522bed9c103c', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8cb5d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:21:07,581: INFO/MainProcess] Task task_call_api[de83bfc7-2329-498e-9ede-821f960c475c] received
[2023-11-08 16:21:07,967: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:21:07,975: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:21:07,976: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,977: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:21:07,978: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:21:07,979: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:21:07,979: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:21:07,980: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:21:07,981: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,982: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:21:07,982: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:21:07,983: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:21:07,983: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:21:07,984: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:21:07,985: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:21:07,985: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:21:07,986: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,986: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:21:07,987: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:21:07,988: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:21:07,989: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:21:07,990: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:21:07,990: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,991: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:21:07,992: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:21:07,992: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:21:07,993: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:21:07,994: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,995: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,995: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,996: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,997: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,997: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,998: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:07,998: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:21:07,999: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:21:08,000: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:21:08,000: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:21:08,002: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,002: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,003: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,004: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,005: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,005: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:21:08,006: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,007: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,007: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:21:08,008: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,009: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:21:08,010: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:21:08,010: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:21:08,024: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:21:08,025: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:21:08,026: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:21:08,026: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:21:08,027: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:21:08,028: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:21:08,028: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:21:08,029: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:21:08,030: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:21:08,031: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:21:08,032: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:21:08,032: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:21:08,033: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:21:08,034: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:21:08,035: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:21:08,035: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:21:08,036: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:21:08,037: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:21:08,038: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:21:08,039: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:21:08,039: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:21:08,040: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:21:08,041: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:21:08,041: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:21:08,042: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:21:08,043: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:21:08,044: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:21:08,044: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:21:08,045: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:21:08,046: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:21:08,046: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:21:08,047: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:21:08,048: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:21:08,048: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:21:08,049: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': 'de83bfc7-2329-498e-9ede-821f960c475c', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b89ae90>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:22:35,546: INFO/MainProcess] Task task_call_api[0a98ddcf-085d-494e-bd9d-c43d7c9fa73f] received
[2023-11-08 16:22:36,371: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:22:36,382: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:22:36,384: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,384: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:22:36,385: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:22:36,386: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:22:36,387: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:22:36,388: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:22:36,389: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,390: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:22:36,391: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:22:36,392: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:22:36,392: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:22:36,393: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:22:36,394: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:22:36,395: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:22:36,395: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,396: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:22:36,398: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:22:36,399: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:22:36,399: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:22:36,401: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:22:36,405: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,406: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:22:36,409: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:22:36,411: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:22:36,414: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:22:36,415: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,417: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,418: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,419: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,420: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,422: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,423: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,424: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:22:36,425: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:22:36,426: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:22:36,427: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:22:36,431: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,433: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,434: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,435: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,436: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,437: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:22:36,438: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,443: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,445: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:22:36,446: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,448: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:22:36,449: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:22:36,451: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:22:36,480: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:22:36,482: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:22:36,486: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:22:36,489: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:22:36,494: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:22:36,495: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:22:36,499: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:22:36,508: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:22:36,512: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:22:36,514: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:22:36,521: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:22:36,524: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:22:36,531: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:22:36,563: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:22:36,644: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:22:36,656: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:22:36,667: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:22:36,671: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:22:36,683: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:22:36,688: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:22:36,690: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:22:36,694: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:22:36,705: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:22:36,713: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:22:36,715: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:22:36,716: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:22:36,722: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:22:36,727: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:22:36,730: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:22:36,733: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:22:36,737: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:22:36,759: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:22:36,773: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:22:36,793: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:22:36,798: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '0a98ddcf-085d-494e-bd9d-c43d7c9fa73f', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8d7710>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:23:29,583: INFO/MainProcess] Task task_call_api[2061ceda-f599-4c95-a133-ac717ccf160b] received
[2023-11-08 16:23:30,180: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:23:30,195: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:23:30,197: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,198: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:23:30,200: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:23:30,202: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:23:30,204: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:23:30,205: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:23:30,213: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,215: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:23:30,217: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:23:30,218: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:23:30,220: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:23:30,222: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:23:30,224: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:23:30,225: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:23:30,228: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,230: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:23:30,232: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:23:30,236: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:23:30,237: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:23:30,238: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:23:30,240: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,243: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:23:30,246: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:23:30,247: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:23:30,249: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:23:30,251: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,253: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,255: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,256: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,258: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,260: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,271: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,277: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:23:30,278: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:23:30,279: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:23:30,280: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:23:30,288: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,289: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,293: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,295: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,298: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,302: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:23:30,303: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,304: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:23:30,321: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,323: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:23:30,324: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:23:30,326: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:23:30,370: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:23:30,371: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:23:30,374: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:23:30,377: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:23:30,382: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:23:30,386: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:23:30,388: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:23:30,401: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:23:30,408: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:23:30,409: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:23:30,413: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:23:30,416: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:23:30,417: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:23:30,418: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:23:30,420: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:23:30,421: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:23:30,425: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:23:30,427: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:23:30,428: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:23:30,429: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:23:30,431: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:23:30,432: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:23:30,434: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:23:30,435: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:23:30,437: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:23:30,439: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:23:30,439: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:23:30,441: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:23:30,444: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:23:30,446: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:23:30,447: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:23:30,448: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:23:30,449: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:23:30,453: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:23:30,455: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '2061ceda-f599-4c95-a133-ac717ccf160b', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e42d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:26:46,058: INFO/MainProcess] Task task_call_api[82568b36-694c-4b0b-aea1-d6728015e579] received
[2023-11-08 16:26:46,869: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:26:46,886: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:26:46,888: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,890: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:26:46,891: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:26:46,893: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:26:46,894: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:26:46,896: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:26:46,910: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,912: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:26:46,913: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:26:46,914: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:26:46,917: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:26:46,918: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:26:46,919: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:26:46,922: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:26:46,924: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,926: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:26:46,930: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:26:46,931: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:26:46,935: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:26:46,945: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:26:46,954: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,955: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:26:46,957: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:26:46,959: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:26:46,963: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:26:46,968: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,970: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,971: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,972: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,973: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,974: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,975: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,976: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:26:46,977: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:26:46,985: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:26:46,987: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:26:46,991: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,992: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,993: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,995: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,997: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:46,998: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:26:46,998: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:47,000: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:47,001: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:26:47,003: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:47,003: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:26:47,004: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:26:47,005: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:26:47,093: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:26:47,095: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:26:47,097: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:26:47,102: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:26:47,104: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:26:47,112: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:26:47,120: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:26:47,123: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:26:47,127: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:26:47,129: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:26:47,130: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:26:47,133: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:26:47,135: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:26:47,145: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:26:47,147: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:26:47,152: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:26:47,153: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:26:47,154: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:26:47,155: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:26:47,158: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:26:47,159: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:26:47,160: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:26:47,162: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:26:47,163: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:26:47,165: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:26:47,172: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:26:47,181: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:26:47,183: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:26:47,185: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:26:47,188: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:26:47,191: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:26:47,193: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:26:47,195: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:26:47,197: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:26:47,200: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '82568b36-694c-4b0b-aea1-d6728015e579', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8c95d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:27:41,089: INFO/MainProcess] Task task_call_api[4ab50f42-9df6-40dc-923c-8e4b38fc3769] received
[2023-11-08 16:27:41,506: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:27:41,527: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:27:41,529: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,530: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:27:41,531: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:27:41,532: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:27:41,533: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:27:41,534: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:27:41,544: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,545: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:27:41,547: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:27:41,547: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:27:41,548: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:27:41,549: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:27:41,550: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:27:41,551: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:27:41,552: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,553: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:27:41,554: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:27:41,555: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:27:41,555: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:27:41,557: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:27:41,558: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,559: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:27:41,560: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:27:41,561: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:27:41,562: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:27:41,564: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,565: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,565: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,566: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,567: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,568: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,569: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,570: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:27:41,571: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:27:41,572: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:27:41,573: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:27:41,576: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,577: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,578: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,579: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,580: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,581: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:27:41,581: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,583: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,584: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:27:41,587: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,588: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:27:41,588: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:27:41,589: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:27:41,617: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:27:41,619: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:27:41,621: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:27:41,622: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:27:41,624: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:27:41,626: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:27:41,630: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:27:41,633: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:27:41,636: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:27:41,638: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:27:41,641: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:27:41,643: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:27:41,645: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:27:41,647: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:27:41,649: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:27:41,651: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:27:41,653: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:27:41,655: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:27:41,657: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:27:41,659: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:27:41,661: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:27:41,663: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:27:41,666: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:27:41,669: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:27:41,670: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:27:41,673: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:27:41,674: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:27:41,675: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:27:41,676: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:27:41,678: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:27:41,679: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:27:41,680: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:27:41,681: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:27:41,682: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:27:41,683: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '4ab50f42-9df6-40dc-923c-8e4b38fc3769', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e9050>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:29:49,034: INFO/MainProcess] Task task_call_api[9cc7d3c3-0d87-47ff-86e6-3f1070e96eb7] received
[2023-11-08 16:29:49,510: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:29:49,516: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:29:49,517: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,518: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:29:49,519: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:29:49,519: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:29:49,520: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:29:49,520: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:29:49,522: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,523: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:29:49,523: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:29:49,524: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:29:49,524: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:29:49,525: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:29:49,525: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:29:49,526: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:29:49,526: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,527: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:29:49,527: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:29:49,528: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:29:49,528: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:29:49,529: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:29:49,529: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,530: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:29:49,530: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:29:49,531: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:29:49,531: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:29:49,532: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,532: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,533: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,534: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,534: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,535: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,535: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,536: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:29:49,536: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:29:49,537: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:29:49,537: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:29:49,539: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,539: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,540: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,540: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,541: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,541: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:29:49,542: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,543: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,543: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:29:49,544: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,545: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:29:49,545: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:29:49,546: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:29:49,559: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:29:49,559: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:29:49,560: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:29:49,561: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:29:49,561: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:29:49,562: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:29:49,562: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:29:49,563: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:29:49,563: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:29:49,564: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:29:49,564: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:29:49,565: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:29:49,565: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:29:49,566: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:29:49,566: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:29:49,567: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:29:49,567: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:29:49,568: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:29:49,568: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:29:49,569: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:29:49,569: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:29:49,569: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:29:49,570: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:29:49,570: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:29:49,571: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:29:49,571: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:29:49,572: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:29:49,572: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:29:49,573: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:29:49,573: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:29:49,574: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:29:49,574: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:29:49,575: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:29:49,576: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:29:49,576: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '9cc7d3c3-0d87-47ff-86e6-3f1070e96eb7', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8f5e10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:34:10,981: INFO/MainProcess] Task task_call_api[88f6a71d-76d0-4ecc-af93-761539f21264] received
[2023-11-08 16:34:11,592: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:34:11,605: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:34:11,609: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,611: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:34:11,616: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:34:11,619: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:34:11,621: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:34:11,623: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:34:11,631: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,633: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:34:11,635: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:34:11,637: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:34:11,638: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:34:11,640: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:34:11,642: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:34:11,643: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:34:11,646: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,648: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:34:11,649: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:34:11,650: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:34:11,651: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:34:11,653: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:34:11,657: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,658: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:34:11,660: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:34:11,662: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:34:11,664: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:34:11,678: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,695: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,704: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,706: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,708: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,712: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,716: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,721: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:34:11,724: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:34:11,727: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:34:11,728: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:34:11,733: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,734: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,735: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,736: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,743: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,747: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:34:11,748: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,749: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,753: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:34:11,756: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,768: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:34:11,770: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:34:11,771: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:34:11,842: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:34:11,843: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:34:11,845: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:34:11,852: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:34:11,854: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:34:11,855: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:34:11,856: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:34:11,857: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:34:11,858: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:34:11,858: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:34:11,859: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:34:11,860: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:34:11,861: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:34:11,861: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:34:11,862: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:34:11,863: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:34:11,864: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:34:11,881: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:34:11,882: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:34:11,883: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:34:11,884: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:34:11,986: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:34:11,987: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:34:11,987: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:34:12,010: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:34:12,011: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:34:12,012: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:34:12,013: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:34:12,013: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:34:12,014: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:34:12,015: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:34:12,016: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:34:12,016: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:34:12,017: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:34:12,018: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '88f6a71d-76d0-4ecc-af93-761539f21264', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8a6d50>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:35:07,907: INFO/MainProcess] Task task_call_api[1a48455f-6b80-4d66-adbc-00844291699e] received
[2023-11-08 16:35:08,195: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:35:08,213: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:35:08,216: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,218: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:35:08,220: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:35:08,222: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:35:08,223: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:35:08,224: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:35:08,227: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,228: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:35:08,228: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:35:08,229: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:35:08,230: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:35:08,232: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:35:08,232: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:35:08,235: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:35:08,238: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,239: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:35:08,241: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:35:08,241: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:35:08,242: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:35:08,243: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:35:08,244: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,245: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:35:08,246: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:35:08,247: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:35:08,248: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:35:08,250: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,252: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,254: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,255: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,256: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,257: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,258: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,259: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:35:08,259: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:35:08,260: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:35:08,261: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:35:08,263: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,264: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,265: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,266: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,268: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,269: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:35:08,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,274: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:35:08,275: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,275: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:35:08,276: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:35:08,277: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:35:08,291: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:35:08,292: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:35:08,293: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:35:08,294: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:35:08,295: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:35:08,296: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:35:08,297: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:35:08,297: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:35:08,298: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:35:08,299: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:35:08,300: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:35:08,301: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:35:08,302: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:35:08,303: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:35:08,305: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:35:08,306: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:35:08,307: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:35:08,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:35:08,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:35:08,310: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:35:08,311: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:35:08,313: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:35:08,314: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:35:08,315: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:35:08,316: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:35:08,317: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:35:08,318: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:35:08,319: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:35:08,320: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:35:08,321: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:35:08,322: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:35:08,323: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:35:08,324: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:35:08,325: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:35:08,326: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '1a48455f-6b80-4d66-adbc-00844291699e', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8fa190>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:35:51,598: INFO/MainProcess] Task create_task[8f5fe511-7ac9-4256-aad3-007addb310be] received
[2023-11-08 16:36:11,792: INFO/ForkPoolWorker-7] Task create_task[8f5fe511-7ac9-4256-aad3-007addb310be] succeeded in 20.091305656002078s: True
[2023-11-08 16:39:46,330: INFO/MainProcess] Task task_call_api[03b1287f-b8cf-4ba2-80d4-20ef29407d41] received
[2023-11-08 16:39:46,963: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:39:46,977: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:39:46,979: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:46,983: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:39:46,985: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:39:46,991: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:39:46,996: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:39:47,000: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:39:47,008: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,010: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:39:47,016: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:39:47,018: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:39:47,019: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:39:47,030: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:39:47,040: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:39:47,052: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:39:47,061: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,062: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:39:47,064: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:39:47,065: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:39:47,066: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:39:47,067: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:39:47,069: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,070: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:39:47,071: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:39:47,074: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:39:47,076: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:39:47,078: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,079: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,083: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,085: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,086: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,087: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,092: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,093: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:39:47,094: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:39:47,095: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:39:47,099: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:39:47,136: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,143: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,150: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,153: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,162: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,168: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:39:47,170: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,173: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,175: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:39:47,180: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,181: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:39:47,182: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:39:47,183: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:39:47,271: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:39:47,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:39:47,274: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:39:47,275: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:39:47,276: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:39:47,279: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:39:47,281: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:39:47,284: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:39:47,286: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:39:47,288: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:39:47,289: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:39:47,291: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:39:47,292: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:39:47,293: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:39:47,295: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:39:47,296: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:39:47,297: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:39:47,297: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:39:47,298: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:39:47,299: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:39:47,300: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:39:47,301: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:39:47,302: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:39:47,303: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:39:47,304: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:39:47,305: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:39:47,306: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:39:47,307: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:39:47,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:39:47,310: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:39:47,310: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:39:47,311: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:39:47,313: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:39:47,314: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:39:47,316: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '03b1287f-b8cf-4ba2-80d4-20ef29407d41', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e67d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:40:56,090: INFO/MainProcess] Task task_call_api[3b108723-90d0-48a0-b90f-ca5c2c30a266] received
[2023-11-08 16:40:56,302: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:40:56,307: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:40:56,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,312: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:40:56,312: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:40:56,314: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:40:56,317: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:40:56,318: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:40:56,321: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,322: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:40:56,323: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:40:56,324: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:40:56,326: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:40:56,327: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:40:56,331: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:40:56,333: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:40:56,334: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,335: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:40:56,337: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:40:56,337: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:40:56,338: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:40:56,339: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:40:56,340: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,341: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:40:56,345: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:40:56,346: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:40:56,347: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:40:56,348: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,349: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,350: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,350: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,351: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,352: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,352: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,353: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:40:56,354: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:40:56,354: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:40:56,355: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:40:56,357: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,358: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,358: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,361: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,361: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,362: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:40:56,363: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,363: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,364: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:40:56,365: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,366: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:40:56,367: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:40:56,368: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:40:56,382: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:40:56,383: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:40:56,384: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:40:56,385: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:40:56,386: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:40:56,387: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:40:56,388: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:40:56,389: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:40:56,390: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:40:56,391: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:40:56,392: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:40:56,393: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:40:56,394: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:40:56,395: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:40:56,396: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:40:56,397: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:40:56,398: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:40:56,400: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:40:56,400: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:40:56,401: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:40:56,402: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:40:56,403: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:40:56,403: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:40:56,404: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:40:56,404: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:40:56,405: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:40:56,406: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:40:56,408: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:40:56,409: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:40:56,410: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:40:56,412: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:40:56,413: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:40:56,414: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:40:56,415: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:40:56,417: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '3b108723-90d0-48a0-b90f-ca5c2c30a266', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b90a290>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:41:33,918: INFO/MainProcess] Task task_call_api[5ca8b8bd-2719-492e-9733-25fa504c4622] received
[2023-11-08 16:41:34,214: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:41:34,220: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:41:34,224: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,225: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:41:34,228: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:41:34,229: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:41:34,231: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:41:34,232: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:41:34,234: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,235: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:41:34,236: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:41:34,237: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:41:34,237: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:41:34,238: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:41:34,239: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:41:34,240: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:41:34,241: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,242: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:41:34,243: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:41:34,244: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:41:34,245: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:41:34,246: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:41:34,247: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,248: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:41:34,249: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:41:34,250: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:41:34,251: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:41:34,253: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,254: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,256: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,257: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,259: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,260: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,262: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,263: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:41:34,263: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:41:34,264: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:41:34,265: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:41:34,268: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,269: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,270: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,271: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,272: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,274: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:41:34,275: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,276: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,277: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:41:34,278: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,279: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:41:34,280: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:41:34,281: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:41:34,302: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:41:34,304: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:41:34,305: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:41:34,306: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:41:34,307: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:41:34,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:41:34,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:41:34,310: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:41:34,311: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:41:34,312: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:41:34,315: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:41:34,316: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:41:34,317: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:41:34,319: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:41:34,319: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:41:34,320: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:41:34,322: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:41:34,323: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:41:34,324: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:41:34,325: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:41:34,325: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:41:34,327: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:41:34,328: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:41:34,329: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:41:34,330: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:41:34,331: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:41:34,332: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:41:34,333: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:41:34,334: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:41:34,335: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:41:34,335: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:41:34,336: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:41:34,337: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:41:34,338: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:41:34,340: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': '5ca8b8bd-2719-492e-9733-25fa504c4622', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b716d10>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:42:34,463: INFO/MainProcess] Task task_call_api[bb82cf91-ee11-4b01-a742-bf99d363aa9b] received
[2023-11-08 16:42:35,281: WARNING/ForkPoolWorker-7] --- Logging error ---
[2023-11-08 16:42:35,287: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:42:35,288: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,289: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
[2023-11-08 16:42:35,291: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
[2023-11-08 16:42:35,294: WARNING/ForkPoolWorker-7] ConnectionRefusedError: [Errno 111] Connection refused
[2023-11-08 16:42:35,296: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:42:35,297: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:42:35,300: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen
    httplib_response = self._make_request(
                       ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,302: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request
    conn.request(method, url, **httplib_request_kw)
[2023-11-08 16:42:35,305: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
[2023-11-08 16:42:35,306: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1282, in request
    self._send_request(method, url, body, headers, encode_chunked)
[2023-11-08 16:42:35,307: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
[2023-11-08 16:42:35,308: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
[2023-11-08 16:42:35,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output
    self.send(msg)
[2023-11-08 16:42:35,309: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/http/client.py", line 975, in send
    self.connect()
[2023-11-08 16:42:35,312: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
           ^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,315: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
[2023-11-08 16:42:35,316: WARNING/ForkPoolWorker-7] urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused
[2023-11-08 16:42:35,316: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:42:35,317: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:42:35,318: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
[2023-11-08 16:42:35,321: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,323: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment
    raise MaxRetryError(_pool, url, error or ResponseError(cause))
[2023-11-08 16:42:35,324: WARNING/ForkPoolWorker-7] urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:42:35,325: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:42:35,327: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:42:35,329: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,331: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,333: WARNING/ForkPoolWorker-7]   File "/usr/src/app/worker.py", line 29, in task_call_api
    @celery.task(name="task_call_api")
                   ^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,334: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,335: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,337: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,338: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,342: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send
    raise ConnectionError(e, request=request)
[2023-11-08 16:42:35,344: WARNING/ForkPoolWorker-7] requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-11-08 16:42:35,347: WARNING/ForkPoolWorker-7] 
During handling of the above exception, another exception occurred:
[2023-11-08 16:42:35,348: WARNING/ForkPoolWorker-7] Traceback (most recent call last):
[2023-11-08 16:42:35,365: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,366: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,368: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,370: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,371: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,372: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2023-11-08 16:42:35,373: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,374: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,375: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2023-11-08 16:42:35,376: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,377: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2023-11-08 16:42:35,378: WARNING/ForkPoolWorker-7] AttributeError: '_Code' object has no attribute 'co_positions'
[2023-11-08 16:42:35,381: WARNING/ForkPoolWorker-7] Call stack:
[2023-11-08 16:42:35,400: WARNING/ForkPoolWorker-7]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2023-11-08 16:42:35,401: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2023-11-08 16:42:35,402: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2023-11-08 16:42:35,403: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2023-11-08 16:42:35,405: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2023-11-08 16:42:35,406: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2023-11-08 16:42:35,407: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2023-11-08 16:42:35,408: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2023-11-08 16:42:35,409: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2023-11-08 16:42:35,410: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2023-11-08 16:42:35,410: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2023-11-08 16:42:35,411: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2023-11-08 16:42:35,412: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2023-11-08 16:42:35,413: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2023-11-08 16:42:35,414: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2023-11-08 16:42:35,415: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2023-11-08 16:42:35,416: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2023-11-08 16:42:35,416: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2023-11-08 16:42:35,417: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2023-11-08 16:42:35,418: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2023-11-08 16:42:35,418: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2023-11-08 16:42:35,419: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2023-11-08 16:42:35,420: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2023-11-08 16:42:35,421: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2023-11-08 16:42:35,422: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2023-11-08 16:42:35,423: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2023-11-08 16:42:35,424: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2023-11-08 16:42:35,425: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2023-11-08 16:42:35,426: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2023-11-08 16:42:35,426: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2023-11-08 16:42:35,427: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2023-11-08 16:42:35,428: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2023-11-08 16:42:35,429: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2023-11-08 16:42:35,429: WARNING/ForkPoolWorker-7]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2023-11-08 16:42:35,431: WARNING/ForkPoolWorker-7] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@42754b1628c9', 'id': 'bb82cf91-ee11-4b01-a742-bf99d363aa9b', 'name': 'task_call_api', 'exc': 'ConnectionError(MaxRetryError("HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))"))', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 174, in _new_conn\n    conn = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 95, in create_connection\n    raise err\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/connection.py", line 85, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 715, in urlopen\n    httplib_response = self._make_request(\n                       ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 416, in _make_request\n    conn.request(method, url, **httplib_request_kw)\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 244, in request\n    super(HTTPConnection, self).request(method, url, body=body, headers=headers)\n  File "/usr/local/lib/python3.11/http/client.py", line 1282, in request\n    self._send_request(method, url, body, headers, encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1328, in _send_request\n    self.endheaders(body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1277, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File "/usr/local/lib/python3.11/http/client.py", line 1037, in _send_output\n    self.send(msg)\n  File "/usr/local/lib/python3.11/http/client.py", line 975, in send\n    self.connect()\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 205, in connect\n    conn = self._new_conn()\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connection.py", line 186, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 489, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/connectionpool.py", line 799, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/urllib3/util/retry.py", line 592, in increment\n    raise MaxRetryError(_pool, url, error or ResponseError(cause))\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 29, in task_call_api\n    @celery.task(name="task_call_api")\n                   ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 115, in post\n    return request("post", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 587, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 701, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/adapters.py", line 565, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host=\'localhost\', port=8004): Max retries exceeded with url: /test_ai (Caused by NewConnectionError(\'<urllib3.connection.HTTPConnection object at 0x7f640b8e28d0>: Failed to establish a new connection: [Errno 111] Connection refused\'))\n', 'args': "['65133650123ad5d80ef0c2d2', 'https://res.cloudinary.com/dbaul3mwo/image/upload/v1699441729/Image/dark2_vfnqnw.jpg']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2023-11-08 16:44:49,404: INFO/MainProcess] Task create_task[790cfe0f-9c5b-4b85-babe-1fc30c6cbfaa] received
[2023-11-08 16:44:59,550: INFO/ForkPoolWorker-7] Task create_task[790cfe0f-9c5b-4b85-babe-1fc30c6cbfaa] succeeded in 10.04771308600175s: True
[2023-11-08 16:48:08,494: INFO/MainProcess] Task create_task[ea355ede-b291-4a4b-bdce-99016125e4dc] received
[2023-11-08 16:48:18,593: INFO/ForkPoolWorker-7] Task create_task[ea355ede-b291-4a4b-bdce-99016125e4dc] succeeded in 10.061058806000801s: True
[2023-11-08 16:49:53,437: INFO/MainProcess] Task create_task[68ed8c0f-b421-4563-b025-729b777b1e24] received
[2023-11-08 16:50:03,567: INFO/ForkPoolWorker-7] Task create_task[68ed8c0f-b421-4563-b025-729b777b1e24] succeeded in 10.066338191005343s: True
[2023-11-08 17:01:46,057: INFO/MainProcess] Connected to redis://redis:6379/0
[2023-11-08 17:01:46,165: INFO/MainProcess] mingle: searching for neighbors
[2023-11-08 17:01:47,474: INFO/MainProcess] mingle: all alone
[2023-11-08 17:01:47,652: INFO/MainProcess] celery@5ba4d88177f3 ready.
[2023-11-08 17:01:47,716: INFO/MainProcess] Task create_task[a3c9fd48-8ba7-42ae-b932-a154ff0474d4] received
[2023-11-08 17:01:47,899: INFO/MainProcess] Events of group {task} enabled by remote.
[2023-11-08 17:01:52,003: INFO/MainProcess] Task create_task[71068c9c-ff57-4ac5-a382-deadae3a59a9] received
[2023-11-08 17:02:13,067: WARNING/ForkPoolWorker-8] Adjusting photo.
[2023-11-08 17:02:13,087: WARNING/ForkPoolWorker-7] Adjusting photo.
[2023-11-08 17:02:36,399: WARNING/ForkPoolWorker-8] Preprocessing image.
[2023-11-08 17:02:37,561: WARNING/ForkPoolWorker-7] Preprocessing image.
[2023-11-08 17:02:39,172: WARNING/ForkPoolWorker-7] Detecting lines.
[2023-11-08 17:02:39,458: WARNING/ForkPoolWorker-7] Detecting staffs.
[2023-11-08 17:02:39,604: WARNING/ForkPoolWorker-7] Detecting blobs.
[2023-11-08 17:02:40,013: WARNING/ForkPoolWorker-8] Detecting lines.
[2023-11-08 17:02:40,734: WARNING/ForkPoolWorker-8] Detecting staffs.
[2023-11-08 17:02:40,953: WARNING/ForkPoolWorker-8] Detecting blobs.
[2023-11-08 17:02:44,335: WARNING/ForkPoolWorker-7] Keypoints length : 50
[2023-11-08 17:02:44,504: WARNING/ForkPoolWorker-7] Detected clef: violin
[2023-11-08 17:02:44,511: WARNING/ForkPoolWorker-7] Extracting notes from blobs.
[2023-11-08 17:02:44,705: WARNING/ForkPoolWorker-8] Keypoints length : 50
[2023-11-08 17:02:45,160: WARNING/ForkPoolWorker-7] Extracted 49 notes.
[2023-11-08 17:02:45,929: WARNING/ForkPoolWorker-8] Detected clef: violin
[2023-11-08 17:02:45,936: WARNING/ForkPoolWorker-7] ['C4', 'B4', 'A4', 'E4', 'G4', 'A4', 'B4', 'C4', 'C5', 'B4', 'B4', 'A4', 'G4', 'G4', 'F4', 'E4', 'B4', 'B4', 'B4', 'A4', 'G4', 'G4', 'F4', 'E4', 'E4', 'C4', 'E4', 'E4', 'E4', 'E4', 'F4', 'F4', 'E4', 'D4', 'D4', 'D4', 'D4', 'E4', 'E4', 'D4', 'C4', 'C4', 'G4', 'G4', 'F4', 'E4', 'F4', 'C4', 'C4']
[2023-11-08 17:02:45,937: WARNING/ForkPoolWorker-8] Extracting notes from blobs.
[2023-11-08 17:02:46,474: WARNING/ForkPoolWorker-8] Extracted 49 notes.
[2023-11-08 17:02:48,712: WARNING/ForkPoolWorker-8] ['C4', 'B4', 'A4', 'E4', 'G4', 'A4', 'B4', 'C4', 'C5', 'B4', 'B4', 'A4', 'G4', 'G4', 'F4', 'E4', 'B4', 'B4', 'B4', 'A4', 'G4', 'G4', 'F4', 'E4', 'E4', 'C4', 'E4', 'E4', 'E4', 'E4', 'F4', 'F4', 'E4', 'D4', 'D4', 'D4', 'D4', 'E4', 'E4', 'D4', 'C4', 'C4', 'G4', 'G4', 'F4', 'E4', 'F4', 'C4', 'C4']
[2023-11-08 17:03:12,254: WARNING/ForkPoolWorker-7] Tệp đã được tải lên thành công.
[2023-11-08 17:03:12,361: WARNING/ForkPoolWorker-7] {'url': 'https://res.cloudinary.com/dbaul3mwo/video/upload/v1699462978/Image/tdlq4o1j08ncxmmruk9a.wav', 'message': 'succes'}
[2023-11-08 17:03:12,473: WARNING/ForkPoolWorker-8] Tệp đã được tải lên thành công.
[2023-11-08 17:03:12,526: WARNING/ForkPoolWorker-8] {'url': 'https://res.cloudinary.com/dbaul3mwo/video/upload/v1699462977/Image/yrhrqpgdadsugvk2fq5s.wav', 'message': 'succes'}
[2023-11-08 17:03:12,618: INFO/ForkPoolWorker-7] Task create_task[a3c9fd48-8ba7-42ae-b932-a154ff0474d4] succeeded in 84.82168449500023s: True
[2023-11-08 17:03:12,683: INFO/ForkPoolWorker-8] Task create_task[71068c9c-ff57-4ac5-a382-deadae3a59a9] succeeded in 80.63894298599917s: True
[2023-11-08 17:04:18,966: INFO/MainProcess] Task task_call_api[ace17607-1896-4233-a0a0-08ba1d285f2d] received
[2023-11-08 17:04:54,597: WARNING/ForkPoolWorker-7] Adjusting photo.
[2023-11-08 17:05:21,863: WARNING/ForkPoolWorker-7] Preprocessing image.
[2023-11-08 17:05:24,490: WARNING/ForkPoolWorker-7] Detecting lines.
[2023-11-08 17:05:24,677: WARNING/ForkPoolWorker-7] Detecting staffs.
[2023-11-08 17:05:24,855: WARNING/ForkPoolWorker-7] Detecting blobs.
[2023-11-08 17:05:27,464: WARNING/ForkPoolWorker-7] Keypoints length : 50
[2023-11-08 17:05:27,646: WARNING/ForkPoolWorker-7] Detected clef: violin
[2023-11-08 17:05:27,647: WARNING/ForkPoolWorker-7] Extracting notes from blobs.
[2023-11-08 17:05:27,706: WARNING/ForkPoolWorker-7] Extracted 49 notes.
[2023-11-08 17:05:27,925: WARNING/ForkPoolWorker-7] ['C4', 'B4', 'A4', 'E4', 'G4', 'A4', 'B4', 'C4', 'C5', 'B4', 'B4', 'A4', 'G4', 'G4', 'F4', 'E4', 'B4', 'B4', 'B4', 'A4', 'G4', 'G4', 'F4', 'E4', 'E4', 'C4', 'E4', 'E4', 'E4', 'E4', 'F4', 'F4', 'E4', 'D4', 'D4', 'D4', 'D4', 'E4', 'E4', 'D4', 'C4', 'C4', 'G4', 'G4', 'F4', 'E4', 'F4', 'C4', 'C4']
[2023-11-08 17:05:39,625: WARNING/ForkPoolWorker-7] Tệp đã được tải lên thành công.
[2023-11-08 17:05:39,685: WARNING/ForkPoolWorker-7] {'url': 'https://res.cloudinary.com/dbaul3mwo/video/upload/v1699463138/Image/awmv3wbywqmiyliylon2.wav', 'message': 'succes'}
[2023-11-08 17:05:39,919: INFO/ForkPoolWorker-7] Task task_call_api[ace17607-1896-4233-a0a0-08ba1d285f2d] succeeded in 80.58235019800486s: True
